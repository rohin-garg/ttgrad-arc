file_names=("af24b4cc" "e1d2900e" "903d1b4a" "4e469f39" "b1fc8b8e" "2c737e39" "992798f6" "00576224" "48131b3c" "60a26a3e" "59341089" "31d5ba1a" "e633a9e5" "62ab2642" "73c3b0d8" "c663677b" "c48954c1" "08573cc6" "136b0064" "929ab4e9" "5b526a93" "ef26cbf6" "fafd9572" "67c52801" "ad7e01d0" "506d28a5" "27a77e38" "d492a647" "72a961c9" "fd4b2b02" "bf89d739" "f5aa3634" "b942fd60" "d282b262" "9772c176" "ed74f2f2" "184a9768" "94133066" "256b0a75" "e681b708" "ce8d95cc" "817e6c09" "7d18a6fb" "1da012fc" "310f3251" "bf699163" "917bccba" "551d5bf1" "b457fec5" "50a16a69" "7953d61e" "9a4bb226" "c97c0139" "d4b1c2b1" "1d398264" "29700607" "8597cfd7" "a59b95c0" "2f0c5170" "bd14c3bf" "9caba7c3" "e6de6e8f" "da515329" "31adaf00" "f5c89df1" "be03b35f" "833dafe3" "6ea4a07e" "2546ccf6" "21f83797" "696d4842" "d94c3b52" "4ff4c9da" "3979b1a8" "bf32578f" "d304284e" "c62e2108" "b0722778" "d19f7514" "358ba94e" "d017b73f" "4c177718" "b7999b51" "e345f17b" "e4075551" "50aad11f" "66e6c45b" "c074846d" "0b17323b" "4b6b68e5" "84db8fc4" "ff72ca3e" "8ee62060" "52fd389e" "ae58858e" "fea12743" "0f63c0b9" "e99362f0" "195ba7dc" "f3cdc58f" "a8610ef7" "e760a62e" "aa300dc3" "ea9794b1" "e41c6fd3" "5d2a5c43" "e66aafb8" "ca8de6ea" "19bb5feb" "7c8af763" "e872b94a" "6f473927" "ac605cbb" "ac3e2b04" "0e671a1a" "ac0c5833" "fb791726" "351d6448" "ce039d91" "45bbe264" "332efdb3" "c64f1187" "5b6cbef5" "1d0a4b61" "42918530" "7bb29440" "3a301edc" "896d5239" "505fff84" "cfb2ce5a" "140c817e" "69889d6e" "20818e16" "9b2a60aa" "626c0bcc" "a57f2f04" "477d2879" "05a7bcf2" "81c0276b" "ba9d41b8" "e133d23d" "604001fa" "3ee1011a" "85b81ff1" "17b80ad2" "9b365c51" "e7dd8335" "2a5f8217" "712bf12e" "84f2aca1" "ac2e8ecf" "e2092e0c" "33b52de3" "5833af48" "319f2597" "aa18de87" "cb227835" "e74e1818" "15663ba9" "b4a43f3b" "281123b4" "fc754716" "e5790162" "94414823" "642d658d" "96a8c0cd" "2697da3f" "e9b4f6fc" "bcb3040b" "55783887" "1acc24af" "981571dc" "705a3229" "1c02dbbe" "ca8f78db" "1e97544e" "92e50de0" "e57337a4" "4852f2fa" "7d1f7ee8" "e1baa8a4" "14754a24" "62b74c02" "7d419a02" "94be5b80" "68b67ca3" "2072aba6" "fe9372f3" "137f0df0" "c6e1b8da" "16b78196" "1c0d0a4b" "f0afb749" "de493100" "1990f7a8" "423a55dc" "2753e76c" "f21745ec" "bc4146bd" "79fb03f4" "3d31c5b3" "c35c1b4c" "cf133acc" "da2b0fe3" "15696249" "0c9aba6e" "e7a25a18" "d5c634a2" "414297c0" "009d5c81" "0becf7df" "f3e62deb" "58743b76" "9b4c17c4" "891232d6" "4e45f183" "c7d4e6ad" "a04b2602" "d37a1ef5" "25094a63" "0c786b71" "f3b10344" "b7f8a4d8" "b7cb93ac" "b15fca0b" "1a6449f1" "67636eac" "f823c43c" "27f8ce4f" "fd096ab6" "0a1d4ef5" "6a11f6da" "8fbca751" "6ad5bdfd" "3ed85e70" "09c534e7" "642248e4" "9f27f097" "50f325b5" "88207623" "45737921" "11e1fe23" "aee291af" "90347967" "e7b06bea" "03560426" "e7639916" "e21a174a" "4aab4007" "c658a4bd" "5783df64" "1c56ad9f" "c1990cce" "93c31fbe" "5af49b42" "7e02026e" "2685904e" "c8b7cc0f" "15113be4" "b20f7c8b" "575b1a71" "e0fb7511" "3b4c2228" "32e9702f" "ccd554ac" "af22c60d" "bbb1b8b6" "f9d67f8b" "0d87d2a6" "ed98d772" "9ddd00f0" "070dd51e" "9356391f" "4acc7107" "47996f11" "8dae5dfc" "e5c44e8f" "e9bb6954" "dc2aa30b" "d2acf2cb" "292dd178" "f9a67cb5" "20981f0e" "12997ef3" "103eff5b" "770cc55f" "0692e18c" "8719f442" "e88171ec" "95a58926" "639f5a19" "40f6cd08" "3f23242b" "d47aa2ff" "5b692c0f" "a934301b" "a3f84088" "72207abc" "73182012" "0a2355a6" "a680ac02" "58e15b12" "64a7c07e" "e9c9d9a1" "12eac192" "dc2e9a9d" "ecaa0ec1" "4cd1b7b2" "7c9b52a0" "3391f8c0" "9c56f360" "0607ce86" "97239e3d" "a406ac07" "baf41dbf" "c3202e5a" "13713586" "42a15761" "e619ca6e" "e69241bd" "d56f2372" "5207a7b5" "8ba14f53" "b0f4d537" "aa4ec2a5" "3490cc26" "9def23fe" "d4c90558" "12422b43" "99306f82" "516b51b7" "cad67732" "f4081712" "212895b5" "67b4a34d" "845d6e51" "66f2d22f" "73ccf9c2" "f83cb3f6" "d931c21c" "17cae0c1" "22a4bbc2" "0934a4d8" "8cb8642d" "1e81d6f9" "85fa5666" "0bb8deee" "55059096" "4364c1c4" "4f537728" "aab50785" "9110e3c5" "762cd429" "7039b2d7" "bb52a14b" "ea959feb" "dd2401ed" "48f8583b" "2b01abd0" "b7fb29bc" "8b28cd80" "782b5218" "5a5a2103" "759f3fd3" "e9ac8c9e" "9c1e755f" "37d3e8b2" "9bebae7a" "1a2e2828" "34b99a2b" "60c09cac" "f45f5ca7" "7ee1c6ea" "54db823b" "00dbd492" "b9630600" "2037f2c7" "c87289bb" "692cd3b6" "79369cc6" "c92b942c" "6df30ad6" "a096bf4d" "e78887d1" "5ffb2104" "5289ad53" "8a371977" "f0df5ff0" "df8cc377" "cd3c21df" "963f59bc" "3194b014" "93b4f4b3" "2c0b0aff" "456873bc" "8e2edd66" "f8be4b64" "e95e3d8e" "695367ec" "18419cfa")

NUM_GPUS=8

for (( gpu=0; gpu<NUM_GPUS; gpu++ )); do
  (
    i=0
    for file_name in "${file_names[@]}"; do
      if (( i % NUM_GPUS == gpu )); then
        echo "GPU ${gpu} processing task ${file_name} (ARC-1 VARC-ViT)"
        CUDA_VISIBLE_DEVICES=${gpu} python test_time_train_ARC.py \
          --epochs 100 \
          --depth 10 \
          --batch-size 8 \
          --image-size 64 \
          --patch-size 2 \
          --learning-rate 3e-4 \
          --weight-decay 0 \
          --embed-dim 512 \
          --num-heads 8 \
          --num-colors 12 \
          --resume-checkpoint "saves/offline_train_ViT/checkpoint_best.pt" \
          --lr-scheduler "cosine" \
          --train-split "eval_color_permute_ttt_9/${file_name}" \
          --data-root "raw_data/ARC-AGI" \
          --eval-split "eval_color_permute_ttt_9/${file_name}" \
          --resume-skip-task-token \
          --architecture "vit" \
          --eval-save-name "ARC_1_eval_ViT" \
          --num-attempts 10 \
          --ttt-num-each 2
      fi
      ((i++))
    done
  ) &
done

wait
echo "All VARC-ViT ARC-1  tasks finished."